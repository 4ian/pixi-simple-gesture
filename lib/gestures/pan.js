'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = panable;
function panable(sprite, inertia) {

  function mouseDown(e) {
    start(e.data.originalEvent);
  }

  function touchStart(e) {
    if (e.data.originalEvent.targetTouches && e.data.originalEvent.targetTouches[0]) {
      start(e.data.originalEvent.targetTouches[0]);
    }
  }

  function start(t) {
    if (sprite._pan) {
      if (!sprite._pan.intervalId) {
        return;
      }
      clearInterval(sprite._pan.intervalId);
      sprite.emit('panend');
    }
    sprite._pan = {
      p: {
        x: t.clientX,
        y: t.clientY,
        date: new Date()
      }
    };
    sprite.on('mousemove', mouseMove).on('touchmove', touchMove);
  }

  function mouseMove(e) {
    move(e, e.data.originalEvent);
  }

  function touchMove(e) {
    var t = e.data.originalEvent.targetTouches;
    if (!t || t.length > 1) {
      end(e, t[0]);
      return;
    }
    move(e, t[0]);
  }

  function move(e, t) {
    var now = new Date();
    var interval = now - sprite._pan.p.date;
    if (interval < 12) {
      return;
    }
    var dx = t.clientX - sprite._pan.p.x;
    var dy = t.clientY - sprite._pan.p.y;
    var distance = Math.sqrt(dx * dx + dy * dy);
    if (!sprite._pan.pp) {
      var threshold = t instanceof window.MouseEvent ? 2 : 7;
      if (distance > threshold) {
        sprite.emit('panstart');
      } else {
        return;
      }
    } else {
      var event = {
        deltaX: dx,
        deltaY: dy,
        velocity: distance / interval,
        data: e.data
      };
      sprite.emit('panmove', event);
    }
    sprite._pan.pp = {
      x: sprite._pan.p.x,
      y: sprite._pan.p.y,
      date: sprite._pan.p.date
    };
    sprite._pan.p = {
      x: t.clientX,
      y: t.clientY,
      date: now
    };
  }

  function mouseUp(e) {
    end(e, e.data.originalEvent);
  }

  function touchEnd(e) {
    end(e, e.data.originalEvent.changedTouches[0]);
  }

  function end(e, t) {
    sprite.removeListener('mousemove', mouseMove).removeListener('touchmove', touchMove);
    if (!sprite._pan || !sprite._pan.pp) {
      sprite._pan = null;
      return;
    }
    if (inertia) {
      if (sprite._pan.intervalId) {
        return;
      }
      var interval = new Date() - sprite._pan.pp.date;
      var vx = (t.clientX - sprite._pan.pp.x) / interval;
      var vy = (t.clientY - sprite._pan.pp.y) / interval;
      sprite._pan.intervalId = setInterval(function () {
        if (Math.abs(vx) < 0.04 && Math.abs(vy) < 0.04) {
          clearInterval(sprite._pan.intervalId);
          sprite.emit('panend');
          sprite._pan = null;
          return;
        }
        var touch = {
          clientX: sprite._pan.p.x + vx * 12,
          clientY: sprite._pan.p.y + vy * 12
        };
        move(e, touch);
        vx *= 0.9;
        vy *= 0.9;
      }, 12);
    } else {
      sprite.emit('panend');
      sprite._pan = null;
    }
  }

  sprite.interactive = true;
  sprite.on('mousedown', mouseDown).on('touchstart', touchStart).on('mouseup', mouseUp).on('mouseupoutside', mouseUp).on('touchend', touchEnd).on('touchendoutside', touchEnd);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9nZXN0dXJlcy9wYW4uanMiXSwibmFtZXMiOlsicGFuYWJsZSIsInNwcml0ZSIsImluZXJ0aWEiLCJtb3VzZURvd24iLCJlIiwic3RhcnQiLCJkYXRhIiwib3JpZ2luYWxFdmVudCIsInRvdWNoU3RhcnQiLCJ0YXJnZXRUb3VjaGVzIiwidCIsIl9wYW4iLCJpbnRlcnZhbElkIiwiY2xlYXJJbnRlcnZhbCIsImVtaXQiLCJwIiwieCIsImNsaWVudFgiLCJ5IiwiY2xpZW50WSIsImRhdGUiLCJEYXRlIiwib24iLCJtb3VzZU1vdmUiLCJ0b3VjaE1vdmUiLCJtb3ZlIiwibGVuZ3RoIiwiZW5kIiwibm93IiwiaW50ZXJ2YWwiLCJkeCIsImR5IiwiZGlzdGFuY2UiLCJNYXRoIiwic3FydCIsInBwIiwidGhyZXNob2xkIiwid2luZG93IiwiTW91c2VFdmVudCIsImV2ZW50IiwiZGVsdGFYIiwiZGVsdGFZIiwidmVsb2NpdHkiLCJtb3VzZVVwIiwidG91Y2hFbmQiLCJjaGFuZ2VkVG91Y2hlcyIsInJlbW92ZUxpc3RlbmVyIiwidngiLCJ2eSIsInNldEludGVydmFsIiwiYWJzIiwidG91Y2giLCJpbnRlcmFjdGl2ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7a0JBQXdCQSxPO0FBQVQsU0FBU0EsT0FBVCxDQUFrQkMsTUFBbEIsRUFBMEJDLE9BQTFCLEVBQW1DOztBQUVoRCxXQUFTQyxTQUFULENBQW9CQyxDQUFwQixFQUF1QjtBQUNyQkMsVUFBTUQsRUFBRUUsSUFBRixDQUFPQyxhQUFiO0FBQ0Q7O0FBRUQsV0FBU0MsVUFBVCxDQUFxQkosQ0FBckIsRUFBd0I7QUFDdEIsUUFBSUEsRUFBRUUsSUFBRixDQUFPQyxhQUFQLENBQXFCRSxhQUFyQixJQUFzQ0wsRUFBRUUsSUFBRixDQUFPQyxhQUFQLENBQXFCRSxhQUFyQixDQUFtQyxDQUFuQyxDQUExQyxFQUFpRjtBQUMvRUosWUFBTUQsRUFBRUUsSUFBRixDQUFPQyxhQUFQLENBQXFCRSxhQUFyQixDQUFt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QUFjWixPQUFPVSxJQUFQLENBQVlDLFVBQTFCO0FBQ0FYLGlCQUFPYSxJQUFQLENBQVksUUFBWjtBQUNBYixpQkFBT1UsSUFBUCxHQUFjLElBQWQ7QUFDQTtBQUNEO0FBQ0QsWUFBSXdDLFFBQVE7QUFDVmxDLG1CQUFTaEIsT0FBT1UsSUFBUCxDQUFZSSxDQUFaLENBQWNDLENBQWQsR0FBa0IrQixLQUFLLEVBRHRCO0FBRVY1QixtQkFBU2xCLE9BQU9VLElBQVAsQ0FBWUksQ0FBWixDQUFjRyxDQUFkLEdBQWtCOEIsS0FBSztBQUZ0QixTQUFaO0FBSUF2QixhQUFLckIsQ0FBTCxFQUFRK0MsS0FBUjtBQUNBSixjQUFNLEdBQU47QUFDQUMsY0FBTSxHQUFOO0FBQ0QsT0Fkd0IsRUFjdEIsRUFkc0IsQ0FBekI7QUFlRCxLQXRCRCxNQXNCTztBQUNML0MsYUFBT2EsSUFBUCxDQUFZLFFBQVo7QUFDQWIsYUFBT1UsSUFBUCxHQUFjLElBQWQ7QUFDRDtBQUNGOztBQUVEVixTQUFPbUQsV0FBUCxHQUFxQixJQUFyQjtBQUNBbkQsU0FDR3FCLEVBREgsQ0FDTSxXQUROLEVBQ21CbkIsU0FEbkIsRUFFR21CLEVBRkgsQ0FFTSxZQUZOLEVBRW9CZCxVQUZwQixFQUdHYyxFQUhILENBR00sU0FITixFQUdpQnFCLE9BSGpCLEVBSUdyQixFQUpILENBSU0sZ0JBSk4sRUFJd0JxQixPQUp4QixFQUtHckIsRUFMSCxDQUtNLFVBTE4sRUFLa0JzQixRQUxsQixFQU1HdEIsRUFOSCxDQU1NLGlCQU5OLEVBTXlCc0IsUUFOekI7QUFPRCIsImZpbGUiOiJwYW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBwYW5hYmxlIChzcHJpdGUsIGluZXJ0aWEpIHtcblxuICBmdW5jdGlvbiBtb3VzZURvd24gKGUpIHtcbiAgICBzdGFydChlLmRhdGEub3JpZ2luYWxFdmVudClcbiAgfVxuXG4gIGZ1bmN0aW9uIHRvdWNoU3RhcnQgKGUpIHtcbiAgICBpZiAoZS5kYXRhLm9yaWdpbmFsRXZlbnQudGFyZ2V0VG91Y2hlcyAmJiBlLmRhdGEub3JpZ2luYWxFdmVudC50YXJnZXRUb3VjaGVzWzBdKSB7XG4gICAgICBzdGFydChlLmRhdGEub3JpZ2luYWxFdmVudC50YXJnZXRUb3VjaGVzWzBdKVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0YXJ0ICh0KSB7XG4gICAgaWYgKHNwcml0ZS5fcGFuKSB7XG4gICAgICBpZiAoIXNwcml0ZS5fcGFuLmludGVydmFsSWQpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjbGVhckludGVydmFsKHNwcml0ZS5fcGFuLmludGVydmFsSWQpXG4gICAgICBzcHJpdGUuZW1pdCgncGFuZW5kJylcbiAgICB9XG4gICAgc3ByaXRlLl9wYW4gPSB7XG4gICAgICBwOiB7XG4gICAgICAgIHg6IHQuY2xpZW50WCxcbiAgICAgICAgeTogdC5jbGllbnRZLFxuICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpXG4gICAgICB9XG4gICAgfVxuICAgIHNwcml0ZVxuICAgICAgLm9uKCdtb3VzZW1vdmUnLCBtb3VzZU1vdmUpXG4gICAgICAub24oJ3RvdWNobW92ZScsIHRvdWNoTW92ZSlcbiAgfVxuXG4gIGZ1bmN0aW9uIG1vdXNlTW92ZSAoZSkge1xuICAgIG1vdmUoZSwgZS5kYXRhLm9yaWdpbmFsRXZlbnQpXG4gIH1cblxuICBmdW5jdGlvbiB0b3VjaE1vdmUgKGUpIHtcbiAgICBsZXQgdCA9IGUuZGF0YS5vcmlnaW5hbEV2ZW50LnRhcmdldFRvdWNoZXNcbiAgICBpZiAoIXQgfHwgdC5sZW5ndGggPiAxKSB7XG4gICAgICBlbmQoZSwgdFswXSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBtb3ZlKGUsIHRbMF0pXG4gIH1cblxuICBmdW5jdGlvbiBtb3ZlIChlLCB0KSB7XG4gICAgbGV0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBsZXQgaW50ZXJ2YWwgPSBub3cgLSBzcHJpdGUuX3Bhbi5wLmRhdGVcbiAgICBpZiAoaW50ZXJ2YWwgPCAxMikge1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGxldCBkeCA9IHQuY2xpZW50WCAtIHNwcml0ZS5fcGFuLnAueFxuICAgIGxldCBkeSA9IHQuY2xpZW50WSAtIHNwcml0ZS5fcGFuLnAueVxuICAgIGxldCBkaXN0YW5jZSA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSlcbiAgICBpZiAoIXNwcml0ZS5fcGFuLnBwKSB7XG4gICAgICBsZXQgdGhyZXNob2xkID0gKHQgaW5zdGFuY2VvZiB3aW5kb3cuTW91c2VFdmVudCkgPyAyIDogN1xuICAgICAgaWYgKGRpc3RhbmNlID4gdGhyZXNob2xkKSB7XG4gICAgICAgIHNwcml0ZS5lbWl0KCdwYW5zdGFydCcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGV2ZW50ID0ge1xuICAgICAgICBkZWx0YVg6IGR4LFxuICAgICAgICBkZWx0YVk6IGR5LFxuICAgICAgICB2ZWxvY2l0eTogZGlzdGFuY2UgLyBpbnRlcnZhbCxcbiAgICAgICAgZGF0YTogZS5kYXRhXG4gICAgICB9XG4gICAgICBzcHJpdGUuZW1pdCgncGFubW92ZScsIGV2ZW50KVxuICAgIH1cbiAgICBzcHJpdGUuX3Bhbi5wcCA9IHtcbiAgICAgIHg6IHNwcml0ZS5fcGFuLnAueCxcbiAgICAgIHk6IHNwcml0ZS5fcGFuLnAueSxcbiAgICAgIGRhdGU6IHNwcml0ZS5fcGFuLnAuZGF0ZVxuICAgIH1cbiAgICBzcHJpdGUuX3Bhbi5wID0ge1xuICAgICAgeDogdC5jbGllbnRYLFxuICAgICAgeTogdC5jbGllbnRZLFxuICAgICAgZGF0ZTogbm93XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbW91c2VVcCAoZSkge1xuICAgIGVuZChlLCBlLmRhdGEub3JpZ2luYWxFdmVudClcbiAgfVxuXG4gIGZ1bmN0aW9uIHRvdWNoRW5kIChlKSB7XG4gICAgZW5kKGUsIGUuZGF0YS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdKVxuICB9XG5cbiAgZnVuY3Rpb24gZW5kIChlLCB0KSB7XG4gICAgc3ByaXRlXG4gICAgICAucmVtb3ZlTGlzdGVuZXIoJ21vdXNlbW92ZScsIG1vdXNlTW92ZSlcbiAgICAgIC5yZW1vdmVMaXN0ZW5lcigndG91Y2htb3ZlJywgdG91Y2hNb3ZlKVxuICAgIGlmICghc3ByaXRlLl9wYW4gfHwgIXNwcml0ZS5fcGFuLnBwKSB7XG4gICAgICBzcHJpdGUuX3BhbiA9IG51bGxcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoaW5lcnRpYSkge1xuICAgICAgaWYgKHNwcml0ZS5fcGFuLmludGVydmFsSWQpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBsZXQgaW50ZXJ2YWwgPSBuZXcgRGF0ZSgpIC0gc3ByaXRlLl9wYW4ucHAuZGF0ZVxuICAgICAgbGV0IHZ4ID0gKHQuY2xpZW50WCAtIHNwcml0ZS5fcGFuLnBwLngpIC8gaW50ZXJ2YWxcbiAgICAgIGxldCB2eSA9ICh0LmNsaWVudFkgLSBzcHJpdGUuX3Bhbi5wcC55KSAvIGludGVydmFsXG4gICAgICBzcHJpdGUuX3Bhbi5pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBpZiAoTWF0aC5hYnModngpIDwgMC4wNCAmJiBNYXRoLmFicyh2eSkgPCAwLjA0KSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChzcHJpdGUuX3Bhbi5pbnRlcnZhbElkKVxuICAgICAgICAgIHNwcml0ZS5lbWl0KCdwYW5lbmQnKVxuICAgICAgICAgIHNwcml0ZS5fcGFuID0gbnVsbFxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGxldCB0b3VjaCA9IHtcbiAgICAgICAgICBjbGllbnRYOiBzcHJpdGUuX3Bhbi5wLnggKyB2eCAqIDEyLFxuICAgICAgICAgIGNsaWVudFk6IHNwcml0ZS5fcGFuLnAueSArIHZ5ICogMTJcbiAgICAgICAgfVxuICAgICAgICBtb3ZlKGUsIHRvdWNoKVxuICAgICAgICB2eCAqPSAwLjlcbiAgICAgICAgdnkgKj0gMC45XG4gICAgICB9LCAxMilcbiAgICB9IGVsc2Uge1xuICAgICAgc3ByaXRlLmVtaXQoJ3BhbmVuZCcpXG4gICAgICBzcHJpdGUuX3BhbiA9IG51bGxcbiAgICB9XG4gIH1cblxuICBzcHJpdGUuaW50ZXJhY3RpdmUgPSB0cnVlXG4gIHNwcml0ZVxuICAgIC5vbignbW91c2Vkb3duJywgbW91c2VEb3duKVxuICAgIC5vbigndG91Y2hzdGFydCcsIHRvdWNoU3RhcnQpXG4gICAgLm9uKCdtb3VzZXVwJywgbW91c2VVcClcbiAgICAub24oJ21vdXNldXBvdXRzaWRlJywgbW91c2VVcClcbiAgICAub24oJ3RvdWNoZW5kJywgdG91Y2hFbmQpXG4gICAgLm9uKCd0b3VjaGVuZG91dHNpZGUnLCB0b3VjaEVuZClcbn1cbiJdfQ==